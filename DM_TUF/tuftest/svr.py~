import tuf.interposition
from tuf.interposition import urllib2_tuf as urllib2

from twisted.internet import reactor
from twisted.web import proxy, http

class LoggingProxRequest(proxy.ProxyRequest):
     isLeaf = True
     def buildProtocol(self, addr):
        print self.uri
#        return urllib2.urlopen(self.uri)

class LoggingProxy(proxy.Proxy):
    requestFactory = LoggingProxyRequest

class LoggingProxyFactory(http.HTTPFactory):
    def buildProtocol(self, addr):
        return LoggingProxy()


if __name__ == "__main__":
   print "webserver startup\n"
   tuf.interposition.configure()
   reactor.listenTCP(8080, ProxyFactory())
   reactor.run()
